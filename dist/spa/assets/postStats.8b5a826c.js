import{Q as R}from"./QSelect.f3cd3f13.js";import{bL as M,r as b,aK as L,d9 as W,aC as G,ay as K,o as z,h as J,bM as X,g as Y,da as Z,bS as Q,ax as $,cn as ee,cT as te,aI as h,a6 as x,a7 as i,j as s,bb as l,db as P,bH as j,bd as A,bF as C,a4 as B,cV as q,ad as I,F as T,bI as ae,aO as oe,Q as H,N as se,cU as re,a5 as ne}from"./index.0b72ca58.js";import{b as le,Q as U,q as N,p as ie}from"./QPopupProxy.017bb76f.js";import{C as O}from"./ClosePopup.f02dc519.js";import{api as de}from"./axios.7cd29da6.js";import"./selection.8100932a.js";import"./use-cache.b0833c75.js";var ue=M({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(d,{slots:n,emit:p}){const a=Y(),u=b(null);let f=0;const t=[];function y(e){const r=typeof e=="boolean"?e:d.noErrorFocus!==!0,c=++f,w=(o,m)=>{p("validation"+(o===!0?"Success":"Error"),m)},k=o=>{const m=o.validate();return typeof m.then=="function"?m.then(v=>({valid:v,comp:o}),v=>({valid:!1,comp:o,err:v})):Promise.resolve({valid:m,comp:o})};return(d.greedy===!0?Promise.all(t.map(k)).then(o=>o.filter(m=>m.valid!==!0)):t.reduce((o,m)=>o.then(()=>k(m).then(v=>{if(v.valid===!1)return Promise.reject(v)})),Promise.resolve()).catch(o=>[o])).then(o=>{if(o===void 0||o.length===0)return c===f&&w(!0),!0;if(c===f){const{comp:m,err:v}=o[0];if(v!==void 0&&console.error(v),w(!1,m),r===!0){const E=o.find(({comp:F})=>typeof F.focus=="function"&&Z(F.$)===!1);E!==void 0&&E.comp.focus()}}return!1})}function S(){f++,t.forEach(e=>{typeof e.resetValidation=="function"&&e.resetValidation()})}function D(e){e!==void 0&&Q(e);const r=f+1;y().then(c=>{r===f&&c===!0&&(d.onSubmit!==void 0?p("submit",e):e!==void 0&&e.target!==void 0&&typeof e.target.submit=="function"&&e.target.submit())})}function V(e){e!==void 0&&Q(e),p("reset"),$(()=>{S(),d.autofocus===!0&&d.noResetFocus!==!0&&_()})}function _(){ee(()=>{if(u.value===null)return;const e=u.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||u.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||u.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(u.value.querySelectorAll("[tabindex]"),r=>r.tabIndex>-1);e!=null&&e.focus({preventScroll:!0})})}L(W,{bindComponent(e){t.push(e)},unbindComponent(e){const r=t.indexOf(e);r>-1&&t.splice(r,1)}});let g=!1;return G(()=>{g=!0}),K(()=>{g===!0&&d.autofocus===!0&&_()}),z(()=>{d.autofocus===!0&&_()}),Object.assign(a.proxy,{validate:y,resetValidation:S,submit:D,reset:V,focus:_,getValidationComponents:()=>t}),()=>J("form",{class:"q-form",ref:u,onSubmit:D,onReset:V},X(n.default))}});const ce={setup(){const d=new Date,n=le(d,2),p=r=>ie(r,"yyyy/MM/dd"),a=b(p(d)),u=b(p(n)),f=b(!1),t=b(!1),y=b([]),S=b(""),D=b(!1),V=b(!1),_=[{label:"Ocean State Forecast",value:"UG_GMES_ocean_state_forecast"},{label:"Sea Surface Temperature (SST)",value:"SST"},{label:"Sea Surface Currents (SSC)",value:"SSC"},{label:"Salinity (SALT)",value:"SALT"},{label:"Significant Wave Height (SWH)",value:"SWH"},{label:"Sea Surface Height (SSH)",value:"SSH"}],g=r=>r.replace(/\//g,"");return{preferred:S,startDate:a,endDate:u,options:_,submitted:f,submitEmpty:t,submitResult:y,showStartDatePicker:D,showEndDatePicker:V,onSubmit:async()=>{try{const c={startdate:a.value.replace(/\//g,""),enddate:u.value.replace(/\//g,""),variable:S.value.value};console.log(c);const w=await de.post("/run-compute-stats",c);console.log("Success:",w.data),alert("Data submitted successfully.")}catch(c){console.error("Error:",c),alert("An error occurred while submitting the data.")}const r=[{name:"ocean_variable",value:S.value.value},{name:"start_date",value:g(a.value)},{name:"end_date",value:g(u.value)}];f.value=!0,y.value=r,t.value=r.every(c=>!c.value)}}}},me={class:"column items-center justify-center",style:{"min-width":"100vw","min-height":"60vh"}},fe={class:"q-pa-md",style:{width:"50%"}},ve={class:"row q-mb-lg q-pb-md items-center justify-between"},be=i("div",{class:"h6 col-3"},"Select Ocean Variable",-1),pe={class:"col"},ye={class:"row items-center justify-between"},Se=i("div",{class:"col-3 h6"},"Start Date",-1),_e={class:"col"},he={class:"row items-center justify-end"},ge={class:"row items-center justify-between"},De=i("div",{class:"col-3 h6"},"End Date",-1),Ve={class:"col"},we={class:"row items-center justify-end"};function xe(d,n,p,a,u,f){return h(),x("div",me,[i("div",fe,[s(ue,{onSubmit:a.onSubmit,class:"q-gutter-md"},{default:l(()=>[i("div",ve,[be,i("div",pe,[s(R,{name:"ocean_variable",modelValue:a.preferred,"onUpdate:modelValue":n[0]||(n[0]=t=>a.preferred=t),options:a.options,color:"primary",filled:"",clearable:"",label:"Ocean Variable"},null,8,["modelValue","options"])])]),i("div",ye,[Se,i("div",_e,[s(P,{name:"start_date",filled:"",modelValue:a.startDate,"onUpdate:modelValue":n[2]||(n[2]=t=>a.startDate=t),mask:"date",rules:["date"]},{append:l(()=>[s(j,{name:"event",class:"cursor-pointer"},{default:l(()=>[s(U,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[s(N,{modelValue:a.startDate,"onUpdate:modelValue":n[1]||(n[1]=t=>a.startDate=t)},{default:l(()=>[i("div",he,[A(s(C,{label:"Close",color:"primary",flat:""},null,512),[[O]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),i("div",ge,[De,i("div",Ve,[s(P,{name:"end_date",filled:"",modelValue:a.endDate,"onUpdate:modelValue":n[4]||(n[4]=t=>a.endDate=t),mask:"date",rules:["date"]},{append:l(()=>[s(j,{name:"event",class:"cursor-pointer"},{default:l(()=>[s(U,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[s(N,{modelValue:a.endDate,"onUpdate:modelValue":n[3]||(n[3]=t=>a.endDate=t)},{default:l(()=>[i("div",we,[A(s(C,{label:"Close",color:"primary",flat:""},null,512),[[O]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),i("div",null,[s(C,{label:"Submit",type:"submit",color:"primary"})])]),_:1},8,["onSubmit"]),a.submitted?(h(),B(re,{key:0,flat:"",bordered:"",class:se(["q-mt-md",d.$q.dark.isActive?"bg-grey-9":"bg-grey-2"])},{default:l(()=>[a.submitEmpty?(h(),B(q,{key:0},{default:l(()=>[I(" Submitted form contains empty formData. ")]),_:1})):(h(),x(T,{key:1},[s(q,null,{default:l(()=>[I("Submitted form contains the following formData (key = value):")]),_:1}),s(ae),s(q,{class:"row q-gutter-sm items-center"},{default:l(()=>[(h(!0),x(T,null,oe(a.submitResult,(t,y)=>(h(),x("div",{key:y,class:"q-px-sm q-py-xs bg-grey-8 text-white rounded-borders text-center text-no-wrap"},H(t.name)+" = "+H(t.value),1))),128))]),_:1})],64))]),_:1},8,["class"])):ne("",!0)])])}var Ae=te(ce,[["render",xe]]);export{Ae as default};
